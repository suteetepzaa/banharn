<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* ‡πÉ‡∏ä‡πâ‡∏ü‡∏≠‡∏ô‡∏ï‡πå Sarabun ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£ */
        body { font-family: 'Sarabun', 'Kanit', sans-serif; background-color: #f1f5f9; }
        .official-card { background: white; border-top: 6px solid #1e3a8a; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); }
        .header-font { font-family: 'Kanit', sans-serif; }
    </style>
</head>
<body class="min-h-screen py-10 px-4">

    <div class="max-w-3xl mx-auto">
        <div class="text-center mb-8">
            <img src="‡πÉ‡∏™‡πà_URL_‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ï‡∏£‡∏≤‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà" alt="‡∏ï‡∏£‡∏≤‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" 
                 class="h-24 mx-auto mb-4 drop-shadow-sm" 
                 onerror="https://lh3.googleusercontent.com/sitesv/APaQ0SR8LzlggfBvW9jYQiGlhwbASlh6we5Gco_ZIfT48zZrycF9OnE1TFAxgutwP2wSGj8vAl5vULBW9nIdT3zcf-9P44YoOk8mk7H9aOuEXKnKFWAtOOdSoeVPNxRqGejRQDbFkNWb7fMU9tFnFmO1EqYdF9rJdrr9OOkpjsubigWn7zFH4JeoK0KmEJo=w1280'"> 
            
            <h1 class="header-font text-2xl font-bold text-slate-800 uppercase tracking-wide">‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</h1>
            <p class="text-slate-600 font-medium">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 3 ‡πÅ‡∏•‡∏∞ 6 ‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ 2568</p>
            <div class="w-20 h-1 bg-blue-900 mx-auto mt-4 rounded-full"></div>
        </div>

        <div class="official-card p-8 rounded-xl mb-6">
            <div class="max-w-sm mx-auto">
                <label for="studentID" class="block text-sm font-bold text-slate-700 mb-2">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                <div class="flex gap-2">
                    <input type="text" id="studentID" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß 5-10 ‡∏´‡∏•‡∏±‡∏Å" 
                        class="w-full px-4 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-900 focus:border-transparent outline-none transition">
                    <button onclick="searchStudent()" class="bg-[#1e3a8a] text-white px-6 py-2 rounded-md font-bold hover:bg-blue-800 transition shadow-md">
                        ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
                    </button>
                </div>
            </div>
        </div>

        <div id="result" class="hidden animate-in fade-in duration-700">
            <div class="official-card rounded-xl overflow-hidden bg-white shadow-2xl">
                <div class="bg-slate-50 border-b border-slate-100 p-6 text-center">
                    <h2 class="header-font text-lg font-bold text-slate-800">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</h2>
                </div>
                
                <div class="p-8">
                    <table class="w-full text-left border-collapse">
                        <tbody>
                            <tr class="border-b border-slate-100">
                                <td class="py-4 font-bold text-slate-500 w-1/3">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</td>
                                <td id="resID" class="py-4 text-slate-800 font-semibold">-</td>
                            </tr>
                            <tr class="border-b border-slate-100">
                                <td class="py-4 font-bold text-slate-500 text-sm">‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</td>
                                <td id="resName" class="py-4 text-lg text-slate-800 font-semibold">-</td>
                            </tr>
                            <tr class="border-b border-slate-100">
                                <td class="py-4 font-bold text-slate-500">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô / ‡∏´‡πâ‡∏≠‡∏á</td>
                                <td id="resRoom" class="py-4 text-slate-800 font-semibold">-</td>
                            </tr>
                            <tr class="border-b border-slate-100">
                                <td class="py-4 font-bold text-slate-500">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</td>
                                <td class="py-4">
                                    <span id="resStatus" class="font-bold px-3 py-1 rounded text-sm uppercase tracking-wide">
                                        -
                                    </span>
                                </td>
                            </tr>
                            <tr>
                                <td class="py-4 font-bold text-slate-500">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</td>
                                <td id="resDate" class="py-4 text-blue-900 font-bold">-</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="mt-10 flex justify-end">
                        <div class="text-center opacity-40">
                            <p class="text-xs">‡∏≠‡∏≠‡∏Å‡πÇ‡∏î‡∏¢‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ñ‡∏≤‡∏ô‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</p>
                            <p class="text-[10px]">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏°‡∏∑‡πà‡∏≠: <span id="checkTime"></span></p>
                        </div>
                    </div>
                </div>
            </div>
            
            <button onclick="window.print()" class="mt-6 w-full py-2 border-2 border-slate-300 text-slate-500 rounded-lg hover:bg-white hover:text-slate-800 transition text-sm font-bold flex items-center justify-center gap-2">
                üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô
            </button>
        </div>
    </div>

    <script>
        // *** ‡πÉ‡∏™‡πà URL ‡∏Ç‡∏≠‡∏á Google Sheet CSV ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£ Publish to Web ***
        const SHEETS_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS-pgaWBxt9HwAXvHCddIpVX0C-Ae2RvlP0TfiY8QnWrZJ7sR5G_ucK8OYtzUccMNRFsLAxjMv0zFzA/pub?output=csv';

        let studentsData = [];

        window.onload = () => {
            Papa.parse(SHEETS_URL, {
                download: true,
                header: true,
                complete: (results) => {
                    studentsData = results.data;
                }
            });
        };

        function searchStudent() {
            const inputId = document.getElementById('studentID').value.trim();
            const resultBox = document.getElementById('result');
            
            const student = studentsData.find(s => s.student_id === inputId);

            if (student) {
                document.getElementById('resID').innerText = student.student_id;
                document.getElementById('resName').innerText = student.name;
                document.getElementById('resRoom').innerText = student.room;
                document.getElementById('resStatus').innerText = student.status;
                document.getElementById('resDate').innerText = student.approve_date;
                document.getElementById('checkTime').innerText = new Date().toLocaleString('th-TH');

                const statusEl = document.getElementById('resStatus');
                if (student.status.includes("‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥")) {
                    statusEl.className = "font-bold px-3 py-1 rounded text-sm bg-green-100 text-green-700";
                } else {
                    statusEl.className = "font-bold px-3 py-1 rounded text-sm bg-amber-100 text-amber-700";
                }

                resultBox.classList.remove('hidden');
            } else {
                alert("‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢ ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏ö‡∏ö");
                resultBox.classList.add('hidden');
            }
        }
    </script>
</body>
</html>
